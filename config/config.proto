syntax = "proto3";
package config;
import "google/protobuf/duration.proto";

option go_package = "github.com/gernest/vince/config";

message Config {
  int32 port = 1;
  Env env = 2;
  string url = 3;
  Mailer mailer = 4;
  string data_path = 5;
  google.protobuf.Duration flush_interval = 6;
  bool enable_email_verification = 7;
  bool is_self_host = 8;
  LogLevel log_level = 9;
  string secret_key_base = 10;
  Cors cors = 11;
  Ed25519Key ed25519_key_pair = 12;

  message Mailer {
    Address address = 1;
    Smtp smtp = 2;

    message Smtp {
      string host = 1;
      int32 port = 2;
      oneof auth {
        Anonymous anonymous = 3;
        Plain plain = 4;
        OauthBearer oauth_bearer = 5;
      }
    }
    message Anonymous { string trace = 1; }

    message Plain {
      string identity = 1;
      string username = 2;
      string password = 3;
    }

    message OauthBearer {
      string username = 1;
      string token = 2;
      string host = 3;
      int32 port = 4;
    }
  }
  message Address {
    string name = 1;
    string email = 2;
  }

  enum Env {
    DEVELOPMENT = 0;
    STAGING = 1;
    PRODUCTION = 2;
  }

  enum LogLevel {
    debug = 0;
    info = 1;
    warn = 2;
    error = 3;
    fatal = 4;
    panic = 6;
    // NoLevel defines an absent log level.
    no = 7;
    // Disabled disables the logger.
    disabled = 8;
    // TraceLevel defines trace log level.
    trace = -1;
  }

  message Ed25519Key {
    string public_key_path = 1;
    string private_key_path = 2;
  }
}

message Cors {
  string origin = 1;
  bool credentials = 2;
  int32 max_age = 3;
  repeated string headers = 4;
  repeated string expose = 5;
  repeated string methods = 6;
  bool send_preflight_response = 7;
}