syntax = "proto3";
package timeseries;
import "google/protobuf/timestamp.proto";

option go_package = "github.com/gernest/vince/timeseries";

message Entries { repeated Entry events = 1; }

message Entry {
  int64 timestamp = 1;
  string name = 2;
  string domain = 3;
  uint64 user_id = 4;
  uint64 session_id = 5;
  string hostname = 6;
  string pathname = 7;
  string referrer = 8;
  string referrer_source = 9;
  string country_code = 10;
  string screen_size = 11;
  string operating_system = 12;
  string browser = 13;
  string utm_medium = 14;
  string utm_source = 15;
  string utm_campaign = 16;
  string browser_version = 17;
  string operating_system_version = 18;
  string utm_content = 19;
  string utm_term = 20;
  string transferred_from = 21;
  string entry_page = 22;
  string exit_page = 23;
  string city_geo_name_id = 24;
  uint64 page_views = 25;
  uint64 events = 26;
  int32 sign = 27;
  bool is_bounce = 28;
  int64 duration = 29;
  int64 start = 30;
  string region = 31;
  bool is_session = 32;
}

message EntrySegment {
  repeated Entry name = 2;
  repeated Entry domain = 3;
  repeated Entry hostname = 6;
  repeated Entry pathname = 7;
  repeated Entry referrer = 8;
  repeated Entry referrer_source = 9;
  repeated Entry country_code = 10;
  repeated Entry screen_size = 11;
  repeated Entry operating_system = 12;
  repeated Entry browser = 13;
  repeated Entry utm_medium = 14;
  repeated Entry utm_source = 15;
  repeated Entry utm_campaign = 16;
  repeated Entry browser_version = 17;
  repeated Entry operating_system_version = 18;
  repeated Entry utm_content = 19;
  repeated Entry utm_term = 20;
  repeated Entry entry_page = 22;
  repeated Entry exit_page = 23;
  repeated Entry city_geo_name_id = 24;
  repeated Entry region = 31;
}

message Aggr {
  Total total = 1;
  Segment name = 2;
  Segment domain = 3;
  Segment hostname = 6;
  Segment pathname = 7;
  Segment referrer = 8;
  Segment referrer_source = 9;
  Segment country_code = 10;
  Segment screen_size = 11;
  Segment operating_system = 12;
  Segment browser = 13;
  Segment utm_medium = 14;
  Segment utm_source = 15;
  Segment utm_campaign = 16;
  Segment browser_version = 17;
  Segment operating_system_version = 18;
  Segment utm_content = 19;
  Segment utm_term = 20;
  Segment entry_page = 22;
  Segment exit_page = 23;
  Segment city_geo_name_id = 24;
  Segment region = 31;

  message Total {
    uint64 visitors = 1;
    uint64 visits = 2;
    int64 events = 3;
  }

  message Segment { map<string, Total> aggregates = 1; }

  message Year {
    uint32 year = 1;
    repeated Total months = 2;
  }

  message Month {
    MONTH month = 1;
    repeated Total days = 2;
  }

  message Day {
    google.protobuf.Timestamp date = 1;
    // Size 24, aggregates all hourly totals
    repeated Total hours = 2;
  }

  enum MONTH {
    January = 0;
    February = 1;
    March = 2;
    April = 3;
    May = 4;
    June = 5;
    July = 6;
    August = 7;
    September = 8;
    October = 9;
    November = 10;
    December = 11;
  }
}

enum PROPS {
  unknown = 0;
  NAME = 1;
  PAGE = 2;
  ENTRY_PAGE = 3;
  EXIT_PAGE = 4;
  REFERRER = 5;
  UTM_MEDIUM = 6;
  UTM_SOURCE = 7;
  UTM_CAMPAIGN = 8;
  UTM_CONTENT = 9;
  UTM_TERM = 10;
  UTM_DEVICE = 11;
  UTM_BROWSER = 12;
  BROWSER_VERSION = 13;
  OS = 14;
  OS_VERSION = 15;
  COUNTRY = 16;
  REGION = 17;
  CITY = 18;
}

enum METRIC_TYPE {
  visitors = 0;
  visits = 1;
  page_views = 2;
  views_per_visit = 3;
  visit_duration = 4;
  bounce_rate = 5;
}

// TABLE marks the namespace on which aggregate data is stored.
enum TABLE {
  RAW = 0;
  HOUR = 1;
  DAY = 2;
  MONTH = 3;
  YEAR = 4;
}
